(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{381:function(t,e,n){var content=n(410);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(43).default)("75ec41fb",content,!0,{sourceMap:!1})},382:function(t,e,n){var content=n(413);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(43).default)("61b3e6e7",content,!0,{sourceMap:!1})},383:function(t,e,n){var content=n(415);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(43).default)("78f1f41e",content,!0,{sourceMap:!1})},409:function(t,e,n){"use strict";n(381)},410:function(t,e,n){(e=n(42)(!1)).push([t.i,".region-map{height:350px!important;width:100%;background:none}",""]),t.exports=e},412:function(t,e,n){"use strict";n(382)},413:function(t,e,n){(e=n(42)(!1)).push([t.i,".bar-chart[data-v-52760b70]{height:300px}",""]),t.exports=e},414:function(t,e,n){"use strict";n(383)},415:function(t,e,n){(e=n(42)(!1)).push([t.i,".filter-text b,.selection-text b{border-bottom:2px solid #eee;cursor:pointer}.is-valid .vs__dropdown-toggle{border-color:#28a745}",""]),t.exports=e},422:function(t,e,n){"use strict";n.r(e);n(11),n(50);var r=n(16),o=(n(13),n(337),n(89),n(90),n(2),n(1),n(4),n(65)),c=n.n(o),l=n(408),d=n.n(l),m=n(113),h=(n(5),n(3),n(0)),f=(n(174),{components:{},props:["region-colours","data","opacity","region","regionName","selectedRegion","geojson"],computed:{options:function(){return{onEachFeature:this.onEachFeatureFunction}},filterRegions:{get:function(){return this.selectedRegion},set:function(t){this.$emit("update:selectedRegion",t)}},onEachFeatureFunction:function(){var t=this;return function(e,n){n.on("mouseover",(function(t){t.target.setStyle({fillOpacity:1})})),n.on("mouseout",(function(e){e.target.setStyle({fillOpacity:t.fillOpacity})})),n.on("click",(function(){t.clickRegion()})),n.bindTooltip(t.regionName,{permanent:!1,sticky:!0})}},fillOpacity:function(){return this.opacity[this.regionName]||0},optionsStyle:function(){return{fillColor:"#585fd2",weight:1,opacity:.5,color:"#bbbbbb",fillOpacity:this.fillOpacity}}},methods:{clickRegion:function(){console.log("clicked region");var t=this.filterRegions.indexOf(this.regionName);t>-1?this.filterRegions.splice(t,1):this.filterRegions.push(this.regionName)}}}),v=n(49),y=Object(v.a)(f,(function(){var t=this.$createElement;return(this._self._c||t)("l-geo-json",{ref:"geoJson",attrs:{geojson:this.geojson,options:this.options,"options-style":this.optionsStyle}})}),[],!1,null,null,null).exports,_=(n(175),{components:{RegionMapFeature:y},props:["data","selectedRegion","regions","regionColours","summaryType"],data:function(){return{zoom:5,center:[5,45],mapControls:{zoomControl:!1,attributionControl:!1,scrollWheelZoom:!1,dragging:!1,keyboard:!1,doubleClickZoom:!1,boxZoom:!1,tap:!1,touchZoom:!1}}},computed:{filterRegions:{get:function(){return this.selectedRegion},set:function(t){this.$emit("update:selectedRegion",t)}},opacity:function(){var t=this;return Object.entries(this.data).reduce((function(summary,e){return void 0===e[1].region||(summary[e[1].region]=e[1][t.summaryType]/t.data.total*10),summary}),{})}}}),O=(n(409),Object(v.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("l-map",{staticClass:"region-map",attrs:{zoom:t.zoom,center:t.center,options:t.mapControls}},t._l(t.regions,(function(e){return n("RegionMapFeature",{key:e.region,attrs:{"region-colours":t.regionColours,data:t.data,geojson:e,opacity:t.opacity,region:e.region,"region-name":e.regionName,"selected-region":t.filterRegions},on:{"update:selectedRegion":function(e){t.filterRegions=e},"update:selected-region":function(e){t.filterRegions=e}}})})),1)],1)}),[],!1,null,null,null).exports),x={name:"SummaryBarChart",components:{BarChart:{extends:n(419).a,props:["data","options"],mounted:function(){this.renderChart(this.data,this.options)},watch:{data:function(){this.renderChart(this.data,this.options)}}}},props:["barChartData","labelField","valueField","valueLabel","valuePrecision","step"],data:function(){return{}},computed:{barChartOptions:function(){var t=this;return{maintainAspectRatio:!1,legend:{display:!1},tooltips:{callbacks:{title:function(e,data){return t.chartData.labels[e[0].index]},label:function(e,data){var label=t.valueLabel||"";return label&&(label+=": "),t.valuePrecision?label+=e.yLabel.toLocaleString(void 0,{maximumFractionDigits:t.valuePrecision,minimumFractionDigits:t.valuePrecision}):label+=e.yLabel,label}}},scales:{yAxes:[{ticks:{beginAtZero:!0,precision:this.valuePrecision,stepSize:this.step?this.step:void 0,callback:function(t){return t.toLocaleString(void 0,{maximumFractionDigits:this.valuePrecision,minimumFractionDigits:this.valuePrecision})}},scaleLabel:{display:!0,labelString:this.valueLabel}}],xAxes:[{ticks:{callback:function(t){return t.length>=20?t.slice(0,t.length).substring(0,19).trim()+"...":t}}}]}}},chartData:function(){var t=this;return{datasets:[{label:this.labelField,fill:!0,data:this.barChartData.map((function(e){return e[t.valueField]})).slice(0,20),backgroundColor:["#6e40aa","#6849b9","#6153c7","#585fd2","#4e6cda","#4479df","#3988e1","#2f96e0","#26a5db","#1fb3d3","#1bc1c8","#19cdbb","#1bd9ac","#20e29d","#28ea8d","#34f07e","#44f470","#56f665","#6bf75c","#81f558","#98f357","#aff05b"]}],labels:this.barChartData.map((function(e){return e[t.labelField]})).slice(0,20)}}}};n(412);function C(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var D={components:{BarChart:Object(v.a)(x,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.barChartData.length>0?[t.barChartData?n("BarChart",{staticClass:"bar-chart",attrs:{data:t.chartData,options:t.barChartOptions}}):t._e(),t._v(" "),t.barChartData.length>20?n("p",{staticClass:"text-muted mb-3 mt-3"},[t._v("\n      Showing the top 20 entries. Change view to "),n("b",[t._v("Table")]),t._v(" to view all\n      entries.\n    ")]):t._e()]:[n("div",{staticClass:"bar-chart"},[n("b-alert",{staticClass:"text-center",attrs:{show:"",variant:"secondary"}},[t._v("\n        No data to display. Try adjusting the filters.\n      ")])],1)]],2)}),[],!1,null,"52760b70",null).exports,RegionMap:O},props:["activityData","displaySummary","summaryLabelField","codelists","getCountryName","getSectorName","summaryType","activityTransactionsData","regions","regionColours","selectedRegion"],computed:{valueField:function(){return this.summaryType},valueLabel:function(){return{number_of_projects:"Number of projects",commitments:"Commitments (USD)",disbursements:"Disbursements (USD)"}[this.summaryType]},summaryData:function(){return"number_of_projects"===this.summaryType?this.summaryActivityData:this.summaryActivityTransactionsData},summaryDataMap:function(){var t=this;return function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?C(Object(source),!0).forEach((function(e){Object(h.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):C(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({total:"number_of_projects"===t.summaryType?t.activityData.length:t.activityData.map((function(e){return e[t.summaryType]})).reduce((function(summary,t){return summary+=t}),0)},this.summaryData)},summaryActivityData:function(){var t=this;return Object.values(this.activityData.reduce((function(summary,e){var n=function(t){return t.reportingOrg.text},r=function(e){return t.getCountryName(e)},o=function(e){return t.getSectorName(e)};if("organisation"===t.summaryLabelField){var c=summary[n(e)]?summary[n(e)]:summary[n(e)]={organisation:n(e)};c[t.valueField]?c[t.valueField]+=1:c[t.valueField]=1}else if("country"===t.summaryLabelField){(e.countriesRegions.length>0?e.countriesRegions:[{code:""}]).forEach((function(e){var n=summary[r(e)]?summary[r(e)]:summary[r(e)]={country:r(e)};n[t.valueField]?n[t.valueField]+=1:n[t.valueField]=1}))}else if("sector"===t.summaryLabelField){(e.sectors.length>0?e.sectors:[{code:""}]).forEach((function(e){var n=summary[o(e)]?summary[o(e)]:summary[o(e)]={sector:o(e)};n[t.valueField]?n[t.valueField]+=1:n[t.valueField]=1}))}else if("region"===t.summaryLabelField){(e.locations.length>0?e.locations:[]).forEach((function(e){var n=summary[e]?summary[e]:summary[e]={region:e};n[t.valueField]?n[t.valueField]+=1:n[t.valueField]=1}))}return summary}),{})).sort((function(a,b){return a[t.valueField]>b[t.valueField]?1:-1})).reverse()},summaryActivityTransactionsData:function(){var t=this;if("region"===this.summaryLabelField)return[];var e=function(t){return t.reporting_org_text},n=function(e){return""===e.country_region?"Unspecified":t.getCountryName({code:e.country_region})},r=function(e){return""===e.sector?"Unspecified":t.getSectorName({code:e.sector})};return Object.values(this.activityTransactionsData.reduce((function(summary,o){if("organisation"===t.summaryLabelField)var c=summary[e(o)]?summary[e(o)]:summary[e(o)]={organisation:e(o),commitments:0,disbursements:0};else if("country"===t.summaryLabelField)c=summary[n(o)]?summary[n(o)]:summary[n(o)]={country:n(o),commitments:0,disbursements:0};else if("sector"===t.summaryLabelField)c=summary[r(o)]?summary[r(o)]:summary[r(o)]={sector:r(o),commitments:0,disbursements:0};return"2"===o.transaction_type_code?c.commitments+=o.value_USD_proportionate:"3"===o.transaction_type_code&&(c.disbursements+=o.value_USD_proportionate),summary}),{})).sort((function(a,b){return a[t.valueField]>b[t.valueField]?1:-1})).reverse()},summaryFields:function(){return[{key:this.summaryLabelField,sortable:!0},{key:this.valueField,sortable:!0,thClass:"text-right",tdClass:"text-right",formatter:"valueFormatter"}]}},methods:{valueFormatter:function(t){return t?Math.round(t):0}}},S=Object(v.a)(D,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("client-only",["map"===t.displaySummary?n("RegionMap",{attrs:{data:t.summaryDataMap,"selected-region":t.selectedRegion,"region-colours":t.regionColours,regions:t.regions,"summary-type":t.summaryType},on:{"update:selectedRegion":function(e){t.selectedRegion=e},"update:selected-region":function(e){t.selectedRegion=e}}}):t._e()],1),t._v(" "),"chart"===t.displaySummary?n("BarChart",{attrs:{"bar-chart-data":t.summaryData,"label-field":t.summaryLabelField,"value-label":t.valueLabel,"value-field":t.valueField,"value-precision":"0"}}):t._e(),t._v(" "),"table"===t.displaySummary?n("b-table",{attrs:{items:t.summaryData,fields:t.summaryFields,"asort-by":"total_value","asort-desc":"true",small:"","head-variant":"dark",bordered:""}}):t._e()],1)}),[],!1,null,null,null).exports,R={components:{},props:["displaySummary","summaryLabelField","selectedCountry","countries","selectedReportingOrg","reportingOrgs","selectedSector","sectors","selectedRegion","regions","selectedSource","selectedHumanitarianDevelopment","summaryType","m49Codelists","activityUsedCodelists","selectedCOVIDMatches","participatingOrganisations","selectedParticipatingOrg"],data:function(){return{summaryLabelOptions:[{value:"organisation",text:"Reporting organisation"},{value:"country",text:"Country"},{value:"sector",text:"Sector"},{value:"region",text:"Region"}],summaryDisplayOptions:[{value:"chart",text:"Chart"},{value:"table",text:"Table"},{value:"map",text:"Map"}],summaryTypeOptions:[{value:"number_of_projects",text:"Number of projects"},{value:"commitments",text:"Commitments"},{value:"disbursements",text:"Disbursements"}],sourceOptions:[{value:"3W",text:"3W"},{value:"IATI",text:"IATI"}],humanitarianDevelopmentOptions:[{value:"humanitarian",text:"Humanitarian"},{value:"humanitarian / development",text:"Humanitarian / Development"},{value:"development",text:"Development"},{value:"unspecified",text:"Unspecified"}],selectedOrganisationType:null,organisationType:[{value:null,text:"Select one..."},{value:"10",text:"Government"},{value:"15",text:"Other Public Sector"},{value:"21",text:"International NGO"},{value:"22",text:"National NGO"},{value:"30",text:"Public Private Partnership"},{value:"40",text:"Multilateral"},{value:"60",text:"Foundation"},{value:"70",text:"Private Sector"},{value:"80",text:"Academic, Training and Research"},{value:"90",text:"Other"}],COVIDMatchesOptions:[{value:"title",text:"Activity Title"},{value:"description",text:"Activity Description"},{value:"GLIDE",text:"GLIDE Code"},{value:"HRP",text:"HRP Code"},{value:"tag",text:"Tag"},{value:"transaction-description",text:"Transaction Description"}]}},computed:{filterText:function(){var t=[];return this.country.length>0&&t.push({text:"in ",filter:this.countryText}),this.organisation.length>0&&t.push({text:"reported by ",filter:this.organisationText}),this.participatingOrg.length>0&&t.push({text:"involving ",filter:this.participatingOrgText}),this.sector.length>0&&t.push({text:"in the sector ",filter:this.sectorText}),this.region.length>0&&t.push({text:"in the region ",filter:this.regionText}),4!==this.humanitarianDevelopment.length&&t.push({text:"classified as ",filter:this.humanitarianDevelopment.join(", ")}),6!==this.COVIDMatches.length&&t.push({text:"matching IATI Publishing Guidance by ",filter:this.COVIDMatchesText.join(", ")}),0===t.length?null:t},countryText:function(){var t=this;return this.countries.filter((function(option){return t.country.includes(option.value)})).map((function(t){return t.text})).join(", ")},sectorText:function(){var t=this;return this.sectors.filter((function(option){return t.sector.includes(option.value)})).map((function(t){return t.text})).join(", ")},regionText:function(){return this.region.join(", ")},participatingOrgText:function(){return this.participatingOrg.join(", ")},organisationText:function(){var t=this;return this.reportingOrgs.filter((function(option){return t.organisation.includes(option.value)})).map((function(t){return t.text})).join(", ")},summaryTypeText:function(){var t=this;return this.summaryTypeOptions.filter((function(option){return option.value===t.summaryType}))[0].text.toLowerCase()},summaryLabelText:function(){var t=this;return this.summaryLabelOptions.filter((function(option){return option.value===t.summaryLabelField}))[0].text.toLowerCase()},COVIDMatchesText:function(){var t=this;return this.COVIDMatchesOptions.filter((function(option){return t.COVIDMatches.includes(option.value)})).map((function(option){return option.text}))},COVIDMatches:{get:function(){return this.selectedCOVIDMatches},set:function(t){this.$emit("update:selectedCOVIDMatches",t)}},source:{get:function(){return this.selectedSource},set:function(t){this.$emit("update:selectedSource",t)}},humanitarianDevelopment:{get:function(){return this.selectedHumanitarianDevelopment},set:function(t){this.$emit("update:selectedHumanitarianDevelopment",t)}},_summaryType:{get:function(){return this.summaryType},set:function(t){this.$emit("update:summaryType",t)}},summary:{get:function(){return this.displaySummary},set:function(t){this.$emit("update:displaySummary",t)}},summaryLabel:{get:function(){return this.summaryLabelField},set:function(t){this.$emit("update:summaryLabelField",t)}},organisation:{get:function(){return this.selectedReportingOrg},set:function(t){this.$emit("update:selectedReportingOrg",t)}},participatingOrg:{get:function(){return this.selectedParticipatingOrg},set:function(t){this.$emit("update:selectedParticipatingOrg",t)}},country:{get:function(){return this.selectedCountry},set:function(t){this.$emit("update:selectedCountry",t)}},sector:{get:function(){return this.selectedSector},set:function(t){this.$emit("update:selectedSector",t)}},region:{get:function(){return this.selectedRegion},set:function(t){this.$emit("update:selectedRegion",t)}}},watch:{selectedOrganisationType:function(t){if(null!=t){var e=this.activityUsedCodelists.reportingOrgTypes[t].filter((function(t){return null!=t}));this.organisation=e||[]}}},methods:{selectCountries:function(t,e){var n=this;this.country=this.countries.filter((function(r){return!r.text.includes("regional")&&(null!=r.value&&n.m49Codelists[t].includes(r.value)===e)})).map((function(t){return t.value}))},resetFilters:function(){this.country=[],this.organisation=[],this.participatingOrg=[],this.sector=[],this.selectedOrganisationType=null,this.region=[]}}},T=(n(414),{components:{IATISummaryPaneControls:Object(v.a)(R,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-row",[n("b-col",[n("h3",[t._v("Summary")]),t._v(" "),n("b-row",{staticClass:"mb-1"},[n("b-col",{attrs:{md:"8"}},[n("p",{staticClass:"lead selection-text"},[t._v("\n            Showing a "),n("b",{directives:[{name:"b-toggle",rawName:"v-b-toggle.controls-sidebar",modifiers:{"controls-sidebar":!0}}]},[t._v(t._s(t.displaySummary))]),t._v(" of\n            "),n("b",{directives:[{name:"b-toggle",rawName:"v-b-toggle.controls-sidebar",modifiers:{"controls-sidebar":!0}}]},[t._v(t._s(t.summaryTypeText))]),t._v(" by\n            "),n("b",{directives:[{name:"b-toggle",rawName:"v-b-toggle.controls-sidebar",modifiers:{"controls-sidebar":!0}}]},[t._v(t._s(t.summaryLabelText))]),t._v(".\n          ")])]),t._v(" "),n("b-col",{staticClass:"text-md-right",attrs:{md:"4"}},[n("b-btn",{directives:[{name:"b-toggle",rawName:"v-b-toggle.controls-sidebar",modifiers:{"controls-sidebar":!0}}],attrs:{variant:"success"}},[t._v("\n            Filter and customise display Â»\n          ")])],1)],1),t._v(" "),n("b-row",[n("b-col",[t.filterText?n("p",{staticClass:"filter-text"},[t._v("\n            Filtered to activities\n            "),t._l(t.filterText,(function(filter){return n("span",{key:filter.filter},[t._v("\n              "+t._s(filter.text)+" "),n("b",{directives:[{name:"b-toggle",rawName:"v-b-toggle.controls-sidebar",modifiers:{"controls-sidebar":!0}}]},[t._v(t._s(filter.filter))])])})),t._v(".\n          ")],2):t._e()])],1)],1)],1),t._v(" "),n("b-sidebar",{attrs:{id:"controls-sidebar",title:"Customise data","no-close-on-route-change":"",width:"500px",right:""}},[n("div",{staticClass:"px-3 py-2"},[n("h4",[t._v("Display as")]),t._v(" "),n("b-form-radio-group",{staticClass:"displaySummaryControls mb-1",staticStyle:{width:"100%"},attrs:{options:t.summaryDisplayOptions,buttons:"","button-variant":"outline-primary",size:"sm"},model:{value:t.summary,callback:function(e){t.summary=e},expression:"summary"}}),t._v(" "),n("hr"),t._v(" "),n("h4",[t._v("Summarise by")]),t._v(" "),n("b-form-radio-group",{staticClass:"displaySummaryControls mb-1",attrs:{options:t.summaryTypeOptions,size:"sm",stacked:""},model:{value:t._summaryType,callback:function(e){t._summaryType=e},expression:"_summaryType"}}),t._v(" "),n("hr"),t._v(" "),n("h4",[t._v("Breakdown by")]),t._v(" "),n("b-form-select",{staticClass:"displaySummaryControls mb-1",attrs:{options:t.summaryLabelOptions,size:"sm"},model:{value:t.summaryLabel,callback:function(e){t.summaryLabel=e},expression:"summaryLabel"}}),t._v(" "),n("hr"),t._v(" "),n("b-row",[n("b-col",[n("h4",[t._v("Filters")])]),t._v(" "),t.filterText?n("b-col",{staticClass:"text-right"},[n("b-btn",{attrs:{variant:"danger",size:"sm"},on:{click:t.resetFilters}},[t._v("\n            Reset\n          ")])],1):t._e()],1),t._v(" "),n("b-form-group",{attrs:{state:t.organisation.length>0||null,label:"Reporting Organisation"}},[n("v-select",{attrs:{options:t.reportingOrgs,"get-option-key":function(option){return option.value},"get-option-label":function(option){return option.text},reduce:function(option){return option.value},label:"text",placeholder:"All organisations",multiple:""},model:{value:t.organisation,callback:function(e){t.organisation=e},expression:"organisation"}})],1),t._v(" "),n("b-form-group",{attrs:{state:t.participatingOrg.length>0||null,label:"Participating Organisation"}},[n("v-select",{attrs:{options:t.participatingOrganisations,"get-option-key":function(option){return option.value},"get-option-label":function(option){return option.text},reduce:function(option){return option.value},label:"text",placeholder:"All organisations",multiple:""},model:{value:t.participatingOrg,callback:function(e){t.participatingOrg=e},expression:"participatingOrg"}})],1),t._v(" "),n("b-form-group",{attrs:{state:t.sector.length>0||null,label:"Sector"}},[n("v-select",{attrs:{options:t.sectors,"get-option-key":function(option){return option.value},"get-option-label":function(option){return option.text},reduce:function(option){return option.value},label:"text",placeholder:"All sectors",multiple:""},model:{value:t.sector,callback:function(e){t.sector=e},expression:"sector"}})],1),t._v(" "),n("b-form-group",{attrs:{state:t.region.length>0||null,label:"Region"}},[n("v-select",{attrs:{options:t.regions,"get-option-key":function(option){return option.regionName},"get-option-label":function(option){return option.regionName},reduce:function(option){return option.regionName},label:"text",placeholder:"All regions",multiple:""},model:{value:t.region,callback:function(e){t.region=e},expression:"region"}})],1),t._v(" "),n("b-form-group",{attrs:{label:"Source"}},[n("b-form-checkbox-group",{attrs:{options:t.sourceOptions,size:"sm",stacked:"",switches:""},model:{value:t.source,callback:function(e){t.source=e},expression:"source"}})],1),t._v(" "),n("b-form-group",{attrs:{label:"Humanitarian / Development"}},[n("b-form-checkbox-group",{attrs:{options:t.humanitarianDevelopmentOptions,size:"sm",stacked:"",switches:""},model:{value:t.humanitarianDevelopment,callback:function(e){t.humanitarianDevelopment=e},expression:"humanitarianDevelopment"}})],1),t._v(" "),n("b-form-group",{attrs:{label:"IATI COVID-19 Publishing Guidance",description:"Select activities based on which part(s) of the IATI COVID-19 Publishing Guidance they use."}},[n("b-form-checkbox-group",{attrs:{options:t.COVIDMatchesOptions,size:"sm",stacked:"",switches:""},model:{value:t.COVIDMatches,callback:function(e){t.COVIDMatches=e},expression:"COVIDMatches"}})],1)],1)])],1)}),[],!1,null,null,null).exports,IATISummaryPane:S},data:function(){return{title:m.a.head.title,displaySummary:"chart",summaryType:"number_of_projects",summaryLabelField:"organisation",summaryLabelFields:[{value:"organisation",text:"Reporting organisation"},{value:"country",text:"Country"}],transactionType:"2",transactionTypes:{2:"Commitments",3:"Disbursements",4:"Expenditure"},selectedCountry:[],selectedReportingOrg:[],selectedSector:[],selectedRegion:[],selectedSource:["3W","IATI"],selectedParticipatingOrg:[],selectedHumanitarianDevelopment:["humanitarian","humanitarian / development","development","unspecified"],downloadURLs:[{format:"Excel (activities)",url:"https://ocha-dap.github.io/covid19-data/xlsx/activities.xlsx"},{format:"Excel (transactions)",url:"https://ocha-dap.github.io/covid19-data/traceability/transactions.xlsx"},{format:"Excel (transactions - by country and sector)",url:"https://ocha-dap.github.io/covid19-data/traceability/transactions_sectors_countries_regions.xlsx"},{format:"JSON",url:"https://ocha-dap.github.io/covid19-data/activities.json"},{format:"XML",url:"https://ocha-dap.github.io/covid19-data/xml/activities.xml"}],currentPage:1,perPage:50,selectedCOVIDMatches:["title","description","GLIDE","HRP","tag","transaction-description"],colours:["#6e40aa","#6849b9","#6153c7","#585fd2","#4e6cda","#4479df","#3988e1","#2f96e0","#26a5db","#1fb3d3","#1bc1c8","#19cdbb","#1bd9ac","#20e29d","#28ea8d","#34f07e","#44f470","#56f665","#6bf75c","#81f558","#98f357","#aff05b"]}},computed:{regionColours:function(){var t=this;return this.regions.reduce((function(summary,e,n){return summary[e.region]=t.colours[n],summary}),{})},geojson:function(){return this.$store.state.geoJSONData},regions:function(){return 0===Object.keys(this.geojson).length?[]:this.geojson.features.map((function(t){return{region:t.properties.admin1Name,regionName:t.properties.admin1Name,features:[t]}}))},displayDoubleCountingWarning:function(){return"organisation"!==this.summaryLabelField&&null===this.selectedReportingOrg},totalRows:function(){return this.activities.length},isBusy:function(){return 0===this.$store.state.originalActivityData.length},urls:function(){return{DATA_URL:"https://brough.io/somalia-3w-iati/somalia-activities.json",ACTIVITY_TRANSACTIONS_DATA_URL:"https://brough.io/somalia-3w-iati/traceability/transactions_sector_country.json",COUNTRIES_CODELIST_URL:"https://codelists.codeforiati.org/api/json/en/Country.json",REGIONS_CODELIST_URL:"https://codelists.codeforiati.org/api/json/en/Region.json",SECTORS_CODELIST_URL:"https://codelists.codeforiati.org/api/json/en/Sector.json",M49_CODELIST_URL:"https://ocha-dap.github.io/covid19-data/m49_countries_simplified.json"}},fields:function(){return[{key:"title",sortable:!0},{key:"reportingOrg",label:"Reported by",sortable:!0},{key:"implementingOrganisations",label:"Implemented by",sortable:!0},{key:"countriesRegions",label:"Country/Region",sortable:!0},{key:"totalAmountUSD",label:"Total Amount (USD)",sortable:!0,formatter:"numberFormatter"},{key:"commitmentsCOVID",label:"Covid-19-specific (USD)",sortable:!0,formatter:"numberFormatter"},{key:"humanitarianDevelopment",label:"Humanitarian?",sortable:!0}]},codelists:function(){return this.$store.state.codelists},tooltips:function(){return this.$store.state.tooltips},activityUsedCodelists:function(){return this.$store.state.activityUsedCodelists},m49Codelists:function(){return this.$store.state.m49Codelists},countries:function(){var t=this;return this.activityUsedCodelists.countriesRegions.reduce((function(summary,e){return summary.push({value:e,text:t.getCountryName({code:e})}),summary}),[]).sort((function(a,b){return a.text<b.text?-1:1}))},reportingOrgs:function(){var t=this;return this.activityUsedCodelists.reportingOrgs.reduce((function(summary,e){var n=t.activityUsedCodelists.reportingOrgNames[e];return summary.push({value:e,text:n}),summary}),[]).sort((function(a,b){return a.text<b.text?-1:1}))},sectors:function(){var t=this;return this.activityUsedCodelists.sectors.reduce((function(summary,e){return summary.push({value:e,text:t.getSectorName({code:e})}),summary}),[]).sort((function(a,b){return a.text<b.text?-1:1}))},participatingOrganisations:function(){return this.activityUsedCodelists.participatingOrgs.all.reduce((function(summary,t){return summary.push({value:t,text:t}),summary}),[]).sort((function(a,b){return a.text<b.text?-1:1}))},originalActivityData:function(){return this.$store.state.originalActivityData},originalActivityTransactionData:function(){return this.$store.state.originalActivityTransactionData},activityTransactions:function(){var t=this;return 0===this.selectedCountry.length&&0===this.selectedReportingOrg.length&&0===this.selectedSector.length&&4===this.selectedHumanitarianDevelopment.length&&6===this.selectedCOVIDMatches.length?this.$store.state.originalActivityTransactionData:this.$store.state.originalActivityTransactionData.filter((function(e){return function(e){return 0===t.selectedReportingOrg.length||t.selectedReportingOrg.includes(e.reporting_org_ref)}(e)&&function(e){return 0===t.selectedCountry.length||t.selectedCountry.includes(e.country_region)}(e)&&function(e){if(4===t.selectedHumanitarianDevelopment.length)return!0;return t.selectedHumanitarianDevelopment.includes({0:"development",1:"humanitarian",false:"development",true:"humanitarian",UNSPECIFIED:"unspecified"}[e.humanitarian])}(e)&&function(e){return 0===t.selectedSector.length||t.selectedSector.includes(e.sector)}(e)&&function(e){return 6===t.selectedCOVIDMatches.length||e.covid_matches.filter((function(e){return t.selectedCOVIDMatches.includes(e)})).length>0}(e)}))},activities:function(){var t=this;return 0===this.selectedCountry.length&&0===this.selectedReportingOrg.length&&0===this.selectedParticipatingOrg.length&&0===this.selectedSector.length&&0===this.selectedRegion.length&&2===this.selectedSource.length&&4===this.selectedHumanitarianDevelopment.length&&6===this.selectedCOVIDMatches.length?this.originalActivityData:this.originalActivityData.filter((function(e){return function(e){return 0===t.selectedReportingOrg.length||t.selectedReportingOrg.includes(e.reportingOrg.ref)}(e)&&function(e){return 0===t.selectedParticipatingOrg.length||(!(!t.selectedParticipatingOrg.includes("")||0!==e.participatingOrgsList.length)||e.participatingOrgsList.filter((function(e){return t.selectedParticipatingOrg.includes(e)})).length>0)}(e)&&function(e){return 0===t.selectedCountry.length||(!(!t.selectedCountry.includes("")||0!==e.countriesRegions.length)||e.countriesRegions.filter((function(e){return t.selectedCountry.includes(e.code)})).length>0)}(e)&&function(e){return 2===t.selectedSource.length||t.selectedSource.includes(e.source)}(e)&&function(e){return 4===t.selectedHumanitarianDevelopment.length||t.selectedHumanitarianDevelopment.includes(e.humanitarianDevelopment)}(e)&&function(e){return 0===t.selectedSector.length||(!(!t.selectedSector.includes("")||0!==e.sectors.length)||e.sectors.filter((function(e){return t.selectedSector.includes(e.code)})).length>0)}(e)&&function(e){return 0===t.selectedRegion.length||e.locations.filter((function(e){return t.selectedRegion.includes(e)})).length>0}(e)&&function(e){return 6===t.selectedCOVIDMatches.length||e.COVIDMatches.filter((function(e){return t.selectedCOVIDMatches.includes(e)})).length>0}(e)}))},urlQuery:function(){var t={};return this.selectedReportingOrg.length>0&&(t.organisation=Object.values(this.selectedReportingOrg).join()),this.selectedCountry.length>0&&(t.country=Object.values(this.selectedCountry).join()),this.selectedSector.length>0&&(t.sector=Object.values(this.selectedSector).join()),this.selectedRegion.length>0&&(t.region=Object.values(this.selectedRegion).join()),this.selectedParticipatingOrg.length>0&&(t.participating_org=Object.values(this.selectedParticipatingOrg).join()),2!==this.selectedSource.length&&(t.source=Object.values(this.selectedSource).join()),4!==this.selectedHumanitarianDevelopment.length&&(t.humanitarian=Object.values(this.selectedHumanitarianDevelopment).join()),"chart"!==this.displaySummary&&(t.display=this.displaySummary),"number_of_projects"!==this.summaryType&&(t.summary=this.summaryType),"organisation"!==this.summaryLabelField&&(t.breakdown=this.summaryLabelField),6!==this.selectedCOVIDMatches.length&&(t.covid_matches=Object.values(this.selectedCOVIDMatches).join()),t}},watch:{selectedCountry:function(t){t&&(this.summaryLabelField="organisation"),this.updateRouter()},selectedReportingOrg:function(t){t&&(this.summaryLabelField="country"),this.updateRouter()},selectedParticipatingOrg:function(t){this.updateRouter()},selectedRegion:function(t){this.updateRouter()},selectedSector:function(t){this.updateRouter()},selectedSource:function(t){this.updateRouter()},selectedHumanitarianDevelopment:function(t){this.updateRouter()},displaySummary:function(t){this.updateRouter()},displayType:function(t){this.updateRouter()},summaryLabelField:function(t){this.updateRouter()},summaryType:function(t){"number_of_projects"!==t&&0===this.originalActivityTransactionData.length&&this.loadActivityTransactionData(),this.updateRouter()},selectedCOVIDMatches:function(t){this.updateRouter()}},mounted:function(){var t=this;this.$nextTick((function(){"organisation"in t.$route.query&&(t.selectedReportingOrg=t.$route.query.organisation.split(",")),"country"in t.$route.query&&(t.selectedCountry=t.$route.query.country.split(",")),"participating_org"in t.$route.query&&(t.selectedParticipatingOrg=t.$route.query.participating_org.split(",")),"region"in t.$route.query&&(t.selectedRegion=t.$route.query.region.split(",")),"sector"in t.$route.query&&(t.selectedSector=t.$route.query.sector.split(",")),"summary"in t.$route.query&&(t.summaryType=t.$route.query.summary),"breakdown"in t.$route.query&&(t.summaryLabelField=t.$route.query.breakdown),"display"in t.$route.query&&(t.displaySummary=t.$route.query.display),"source"in t.$route.query&&(t.selectedSource=t.$route.query.source.split(",")),"humanitarian"in t.$route.query&&(t.selectedHumanitarianDevelopment=t.$route.query.humanitarian.split(",")),"covid_matches"in t.$route.query&&(t.selectedCOVIDMatches=t.$route.query.covid_matches.split(",")),0===Object.values(t.codelists.countries).length&&(t.$nuxt.$loading.start(),t.setup())}))},methods:{numberFormatter:function(t){return t?t.toLocaleString(void 0,{maximumFractionDigits:2,minimumFractionDigits:2}):""},getCountryName:function(t){return""===t.code?"Unspecified":this.codelists.countries[t.code]||"Unknown: ".concat(t.code)},getSectorName:function(t){var e=this.codelists.sectors[t.code];return e?"".concat(t.code,": ").concat(e):"".concat(t.code,": Unknown")},setup:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.get("".concat(t.urls.COUNTRIES_CODELIST_URL)).then((function(e){var data=e.data;t.$store.commit("setCodelistsCountry",data.data.reduce((function(t,e){return t[e.code]=e.name,t}),{}))}));case 2:return e.next=4,c.a.get("".concat(t.urls.REGIONS_CODELIST_URL)).then((function(e){var data=e.data;t.$store.commit("setCodelistsCountry",data.data.reduce((function(t,e){return t[e.code]=e.name,t}),t.$store.state.codelists.countries))}));case 4:return e.next=6,c.a.get("".concat(t.urls.SECTORS_CODELIST_URL)).then((function(e){var data=e.data;t.$store.commit("setCodelistsSector",data.data.reduce((function(t,e){return t[e.code]=e.name,t}),{}))}));case 6:return e.next=8,c.a.get("".concat(t.urls.M49_CODELIST_URL)).then((function(e){var data=e.data;t.$store.commit("setM49Codelists",data)}));case 8:t.loadData();case 9:case"end":return e.stop()}}),e)})))()},processActivityData:function(data){return data.map((function(t){return t.totalAmountUSD=t.commitmentsUSD?t.commitmentsUSD:t.budgetsUSD,t._cellVariants={commitmentsCOVID:t.COVIDComponent?"info":null},t}))},loadData:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.get("".concat(t.urls.DATA_URL));case 2:return n=e.sent,r=t.processActivityData(n.data.activities),t.$store.commit("setOriginalActivityData",r),t.$store.commit("setActivityUsedCodelists",n.data.codelists),e.next=8,c.a.get("https://brough.io/somalia-3w-iati/tooltips.csv").then((function(e){return d()().fromString(e.data).then((function(e){t.$store.commit("setTooltips",e)}))}));case 8:return e.next=10,c.a.get("https://brough.io/somalia-3w-iati/somalia-adm1.geojson").then((function(e){t.$store.commit("setGeoJSONData",e.data)}));case 10:t.$nuxt.$loading.finish();case 11:case"end":return e.stop()}}),e)})))()},loadActivityTransactionData:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.get("".concat(t.urls.ACTIVITY_TRANSACTIONS_DATA_URL));case 2:data=e.sent,t.$store.commit("setOriginalActivityTransactionData",data.data),t.$nuxt.$loading.finish();case 5:case"end":return e.stop()}}),e)})))()},updateRouter:function(){this.$router.push({name:"index",query:this.urlQuery})}}}),I=Object(v.a)(T,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-alert",{attrs:{show:"",variant:"warning"}},[t._v("\n    This is a prototype visualisation to show IATI and 3W data. The data on this page comes from\n    "),n("a",{attrs:{href:"https://iatistandard.org"}},[t._v("IATI")]),t._v(".\n  ")]),t._v(" "),n("h2",[t._v("Activities")]),t._v(" "),n("hr"),t._v(" "),t.isBusy?[n("div",{staticClass:"text-center text-secondary"},[n("b-spinner",{staticClass:"align-middle"}),t._v(" "),n("strong",[t._v("Loading...")])],1)]:t._e(),t._v(" "),t.isBusy?t._e():[n("IATISummaryPaneControls",{attrs:{"display-summary":t.displaySummary,"summary-label-field":t.summaryLabelField,"selected-country":t.selectedCountry,countries:t.countries,"selected-reporting-org":t.selectedReportingOrg,"reporting-orgs":t.reportingOrgs,"participating-organisations":t.participatingOrganisations,"selected-participating-org":t.selectedParticipatingOrg,sectors:t.sectors,"selected-sector":t.selectedSector,regions:t.regions,"selected-region":t.selectedRegion,"selected-source":t.selectedSource,"selected-humanitarian-development":t.selectedHumanitarianDevelopment,"summary-type":t.summaryType,"m49-codelists":t.m49Codelists,"activity-used-codelists":t.activityUsedCodelists,"selected-c-o-v-i-d-matches":t.selectedCOVIDMatches},on:{"update:displaySummary":function(e){t.displaySummary=e},"update:display-summary":function(e){t.displaySummary=e},"update:summaryLabelField":function(e){t.summaryLabelField=e},"update:summary-label-field":function(e){t.summaryLabelField=e},"update:selectedCountry":function(e){t.selectedCountry=e},"update:selected-country":function(e){t.selectedCountry=e},"update:selectedReportingOrg":function(e){t.selectedReportingOrg=e},"update:selected-reporting-org":function(e){t.selectedReportingOrg=e},"update:selectedParticipatingOrg":function(e){t.selectedParticipatingOrg=e},"update:selected-participating-org":function(e){t.selectedParticipatingOrg=e},"update:selectedSector":function(e){t.selectedSector=e},"update:selected-sector":function(e){t.selectedSector=e},"update:selectedRegion":function(e){t.selectedRegion=e},"update:selected-region":function(e){t.selectedRegion=e},"update:selectedSource":function(e){t.selectedSource=e},"update:selected-source":function(e){t.selectedSource=e},"update:selectedHumanitarianDevelopment":function(e){t.selectedHumanitarianDevelopment=e},"update:selected-humanitarian-development":function(e){t.selectedHumanitarianDevelopment=e},"update:summaryType":function(e){t.summaryType=e},"update:summary-type":function(e){t.summaryType=e},"update:selectedCOVIDMatches":function(e){t.selectedCOVIDMatches=e},"update:selected-c-o-v-i-d-matches":function(e){t.selectedCOVIDMatches=e}}}),t._v(" "),t.activities?n("IATISummaryPane",{attrs:{"activity-data":t.activities,"activity-transactions-data":t.activityTransactions,"display-summary":t.displaySummary,"summary-label-field":t.summaryLabelField,codelists:t.codelists,"get-country-name":t.getCountryName,"get-sector-name":t.getSectorName,"region-colours":t.regionColours,regions:t.regions,"selected-region":t.selectedRegion,"summary-type":t.summaryType},on:{"update:selectedRegion":function(e){t.selectedRegion=e},"update:selected-region":function(e){t.selectedRegion=e}}}):t._e(),t._v(" "),n("b-alert",{staticClass:"text-muted mb-3 mt-3",attrs:{show:t.displayDoubleCountingWarning,variant:"warning"}},[t._v("\n      The above results may include double counting. "),n("a",{directives:[{name:"b-modal",rawName:"v-b-modal.double-counting-modal",modifiers:{"double-counting-modal":!0}}],attrs:{href:"#"}},[t._v("Read more")]),t._v(".\n    ")]),t._v(" "),n("b-modal",{attrs:{id:"double-counting-modal",title:"Double counting","ok-only":""}},[n("p",[t._v("\n        The visualisation may show double counting, if multiple organisations have published data\n        about the same flows at multiple points in the chain.\n      ")]),t._v(" "),n("p",[t._v("\n        For example, DFID could publish a contribution to a project managed by the World Health\n        Organisation. The WHO could in turn publish the project they are managing. At the moment,\n        the DFID contribution and the WHO's spend on this project would be added together; in reality\n        they should not be added together.\n      ")]),t._v(" "),n("p",[t._v("\n        We are developing methodologies to reduce the scope for this kind of double counting in\n        the visualisation.\n      ")])]),t._v(" "),n("hr"),t._v(" "),n("b-row",[n("b-col",{attrs:{sm:"7",md:"9"}},[n("h3",[t._v(t._s(t.activities.length)+" Activities")])]),t._v(" "),n("b-col",{staticClass:"text-sm-right",attrs:{sm:"5",md:"3"}},[n("b-dropdown",{staticClass:"mb-2",staticStyle:{width:"100%"},attrs:{text:"Download",right:"",variant:"primary"}},t._l(t.downloadURLs,(function(e){return n("b-dropdown-item",{key:e.format,attrs:{href:e.url,target:"_blank"}},[t._v("\n            "+t._s(e.format)+"\n          ")])})),1)],1)],1),t._v(" "),n("b-row",[n("b-col",{staticClass:"my-1",attrs:{sm:"5",md:"6"}},[n("b-form-group",{attrs:{label:"Activities per page","label-cols-sm":"7","label-cols-md":"7","label-cols-lg":"4","label-cols-xl":"3","label-align-sm":"right","label-size":"sm","label-for":"perPageSelect"}},[n("b-form-select",{attrs:{id:"perPageSelect",options:[50,100,500,1e3],size:"sm"},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),t._v(" "),n("b-col",{staticClass:"my-1",attrs:{sm:"7",md:"6"}},[n("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage,align:"fill",size:"sm"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1),t._v(" "),t.activities?n("b-table",{attrs:{items:t.activities,fields:t.fields,"current-page":t.currentPage,"per-page":t.perPage,sortable:"",responsive:""},scopedSlots:t._u([{key:"head()",fn:function(data){return[t._v("\n        "+t._s(data.label)+" "),n("b-badge",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{variant:"secondary",pill:"",title:t.tooltips[data.column]}},[t._v("\n          ?\n        ")])]}},{key:"cell(title)",fn:function(data){return[n("a",{attrs:{href:"http://d-portal.org/q.html?aid="+data.item.iatiIdentifier,target:"_blank"}},[t._v(t._s(data.item.title))])]}},{key:"cell(reportingOrg)",fn:function(data){return[t._v("\n        "+t._s(data.item.reportingOrg.text)+"\n      ")]}},{key:"cell(implementingOrganisations)",fn:function(data){return t._l(data.item.participatingOrganisation[4],(function(e,r){return n("span",{key:data.index+"-"+e.text+"-"+r},[t._v("\n          "+t._s(e.text)+"\n        ")])}))}},{key:"cell(countriesRegions)",fn:function(data){return[data.item.countriesRegions.length>10?[n("span",[t._v("Multiple countries")])]:t._l(data.item.countriesRegions,(function(e){return n("span",{key:data.index+"-"+e.code},[t._v("\n            "+t._s(t.getCountryName(e))+"\n          ")])}))]}}],null,!1,1467225436)}):t._e(),t._v(" "),n("b-row",[n("b-col",{staticClass:"my-1",attrs:{sm:"5",md:"6"}},[n("b-form-group",{attrs:{label:"Activities per page","label-cols-sm":"7","label-cols-md":"7","label-cols-lg":"4","label-cols-xl":"3","label-align-sm":"right","label-size":"sm","label-for":"perPageSelect"}},[n("b-form-select",{attrs:{id:"perPageSelect",options:[50,100,500,1e3],size:"sm"},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),t._v(" "),n("b-col",{staticClass:"my-1",attrs:{sm:"7",md:"6"}},[n("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage,align:"fill",size:"sm"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)]],2)}),[],!1,null,null,null);e.default=I.exports}}]);